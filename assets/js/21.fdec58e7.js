(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{366:function(t,a,s){"use strict";s.r(a);var n=s(0),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"思路概述"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#思路概述"}},[t._v("#")]),t._v(" 思路概述")]),t._v(" "),s("p",[t._v("react-navigation是由官方推荐的用于react-native的路由组件。在一般情况下，如果我们想要进行页面跳转，就要先从props里面取出Navigation，再利用其中的navigate()方法跳转。")]),t._v(" "),s("p",[t._v("然而在某些特殊的情况下，我们没法在组件内部进行路由操作。针对这种情况，官方提供了一套解决方案，大致原理是将路由栈的对象保存起来，这样在没有Props的情况下，就可以从保存的地方将其取出来直接使用。")]),t._v(" "),s("p",[t._v("关于没有props的情况下，如何进行跳转的方法，详见"),s("a",{attrs:{href:"https://reactnavigation.org/docs/zh-Hans/navigating-without-navigation-prop.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("官方文档"),s("OutboundLink")],1),t._v("。")]),t._v(" "),s("p",[t._v("然而，保存起来的路由栈并不等同于props里面的navigation，比我们在组件里面直接调用goback()可以返回上一个页面，但全局保存的路由栈却没法这样使用。后来查看官方文档，发现goBack函数还有一个可选参数，那就是页面的key（可以理解为react-navigation给页面自动生成的唯一标识）。")]),t._v(" "),s("p",[t._v("于是我猜想组件中的navigation之所以可以直接调用goback()，是因为react-navigation已经默认将当前路由的key传了进去。而当我们通过路由栈的对象使用goback()时，也需要传递页面的key进去才行。")]),t._v(" "),s("p",[t._v("知道原因就很好解决了，只要我们手动获得当前页面的key然后传递进去goBack方法就好。在控制台打印一下路由栈对象，可以看到里面有一个_navigator.state.nav.routes属性，路由名称和key都存放在routes这个数组中。有了key的话，接下来怎么做就不用多说了吧。")]),t._v(" "),s("h2",{attrs:{id:"操作步骤"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#操作步骤"}},[t._v("#")]),t._v(" 操作步骤")]),t._v(" "),s("h3",{attrs:{id:"_1-把路由栈保存到全局"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-把路由栈保存到全局"}},[t._v("#")]),t._v(" 1. 把路由栈保存到全局")]),t._v(" "),s("p",[t._v("首先按照"),s("a",{attrs:{href:"https://reactnavigation.org/docs/zh-Hans/navigating-without-navigation-prop.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("官方文档"),s("OutboundLink")],1),t._v("的教程，把路由栈存起来。")]),t._v(" "),s("h3",{attrs:{id:"_2-复制下面的代码。"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-复制下面的代码。"}},[t._v("#")]),t._v(" 2.复制下面的代码。")]),t._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//官方教程中创建的NavigationService.js")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//...这里省略官方教程中的代码")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("goBack")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("key")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" routes"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("_navigator"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nav"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("routes"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" currentPageKey"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("routes"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("routes"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  _navigator"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_navigation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("goBack")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v("currentPageKey"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//...其他函数")]),t._v("\n  goBack\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br")])]),s("h3",{attrs:{id:"_3-使用方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-使用方法"}},[t._v("#")]),t._v(" 3. 使用方法")]),t._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" NavigationService "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'第二步里面的代码所在文件路径'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\nNavigationService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("goBack")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//也可以传入其他路由的key，不传的话默认从当前路由返回上一个页面")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);